<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Universal Wallet Connect</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin-top: 80px; }
    button { padding: 10px 20px; font-size: 16px; cursor: pointer; }
    #status { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>
  <h1>ü™ô Wallet Connect Test</h1>
  <button id="connectWallet">Connect Wallet</button>
  <p id="status">Status: Not connected</p>

  <!-- ‚úÖ Load ethers.js from reliable CDN (v6.x) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.13.2/ethers.umd.min.js"
          integrity="sha512-jmQiBpU2D+eM3Lw45s8hHrR5OTfUNQw4kFklB+fsEX5QwoM3HPuBynLLubnY8coyCUWzcs2yIM02u0DwMeR/zw=="
          crossorigin="anonymous"
          referrerpolicy="no-referrer"></script>

  <!-- ‚úÖ Main Script -->
  <script>
    const btn = document.getElementById("connectWallet");
    const statusEl = document.getElementById("status");

    // Check ethers.js
    if (typeof window.ethers === "undefined") {
      statusEl.textContent = "‚ùå Ethers.js not available. Check internet or CDN blocking.";
      throw new Error("Ethers.js not loaded");
    }

    async function connectWallet() {
      try {
        if (!window.ethereum) {
          alert("No wallet found! Please install MetaMask or a compatible wallet.");
          return;
        }

        // Support for multiple wallets (Brave, Nightly, MetaMask)
        let ethereum = window.ethereum;
        if (Array.isArray(window.ethereum.providers)) {
          const metamask = window.ethereum.providers.find(p => p.isMetaMask);
          if (metamask) ethereum = metamask;
        }

        // Create ethers provider
        const provider = new ethers.BrowserProvider(ethereum);
        const accounts = await ethereum.request({ method: "eth_requestAccounts" });
        const address = accounts[0];
        const network = await provider.getNetwork();

        console.log("Connected account:", address);
        console.log("Network:", network);

        statusEl.textContent = `‚úÖ Connected: ${address.slice(0,6)}...${address.slice(-4)} on ${network.name}`;
      } catch (err) {
        console.error("Wallet connect error:", err);
        statusEl.textContent = "‚ùå " + (err.message || "Connection failed");
      }
    }

    btn.addEventListener("click", connectWallet);
  </script>
</body>
</html>
